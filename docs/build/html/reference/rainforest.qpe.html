

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rainforest.qpe package &mdash; Rainforest QPE library  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Database submodule" href="db.html" />
    <link rel="prev" title="QPE command-line tools" href="qpe_cmd.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Rainforest QPE library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#access-library">Access library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#keeping-database-up-to-date">Keeping database up-to-date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usage.html#keeping-randomforest-model-up-to-date">Keeping randomForest model up-to-date</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="interface.html">Interface</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="qpe.html">QPE submodule</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="qpe_cmd.html">QPE command-line tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="qpe_cmd.html#qpe-compute"><em>qpe_compute</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="qpe_cmd.html#qpe-plot"><em>qpe_plot</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="qpe_cmd.html#qpe-evaluation"><em>qpe_evaluation</em></a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">rainforest.qpe package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-rainforest.qpe.evaluation">rainforest.qpe.evaluation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-rainforest.qpe.qpe">rainforest.qpe.qpe module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-rainforest.qpe.qpe_compute">rainforest.qpe.qpe_compute module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-rainforest.qpe.qpe_evaluation">rainforest.qpe.qpe_evaluation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-rainforest.qpe.qpe_plot">rainforest.qpe.qpe_plot module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db.html">Database submodule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_structure.html">Database structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="db_structure.html#gauge-table"><em>Gauge table</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="db_structure.html#reference-table"><em>Reference table</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="db_structure.html#radar-table"><em>Radar table</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="db_options.html">Database configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_cmd.html">Database command-line tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="db_cmd.html#db-populate"><em>db_populate</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rainforest.database.html">rainforest.database package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rainforest.database.html#module-rainforest.database.database">rainforest.database.database module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.database.html#module-rainforest.database.db_populate">rainforest.database.db_populate module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.database.html#module-rainforest.database.retrieve_radar_data">rainforest.database.retrieve_radar_data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.database.html#module-rainforest.database.retrieve_reference_data">rainforest.database.retrieve_reference_data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.database.html#rainforest-database-retrieve-dwh-data-r-module">rainforest.database.retrieve_dwh_data R module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ml.html">ML submodule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ml_cmd.html">Machine-learning command-line tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ml_cmd.html#rf-train"><em>rf_train</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rainforest.ml.html">rainforest.ml package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rainforest.ml.html#module-rainforest.ml.rf">rainforest.ml.rf module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.ml.html#module-rainforest.ml.rf_train">rainforest.ml.rf_train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.ml.html#module-rainforest.ml.rfdefinitions">rainforest.ml.rfdefinitions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rainforest.ml.html#module-rainforest.ml.utils">rainforest.ml.utils module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="common.html">Common submodule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.io_data">rainforest.common.io_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.retrieve_data">rainforest.common.retrieve_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.radarprocessing">rainforest.common.radarprocessing module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.constants">rainforest.common.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.graphics">rainforest.common.graphics module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.lookup">rainforest.common.lookup module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.utils">rainforest.common.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="common.html#module-rainforest.common.wgs84_ch1903">rainforest.common.wgs84_ch1903 module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rainforest QPE library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Reference</a> &raquo;</li>
        
          <li><a href="qpe.html">QPE submodule</a> &raquo;</li>
        
      <li>rainforest.qpe package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/reference/rainforest.qpe.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rainforest-qpe-package">
<h1>rainforest.qpe package<a class="headerlink" href="#rainforest-qpe-package" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#module-rainforest.qpe.evaluation" title="rainforest.qpe.evaluation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rainforest.qpe.evaluation</span></code></a> : module that deals with evaluation of QPE products</p>
<p><a class="reference internal" href="#module-rainforest.qpe.qpe" title="rainforest.qpe.qpe"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rainforest.qpe.qpe</span></code></a> : main module that computes RF QPE realizations</p>
<p><a class="reference internal" href="#module-rainforest.qpe.qpe_compute" title="rainforest.qpe.qpe_compute"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rainforest.qpe.qpe_compute</span></code></a> : command-line utility to compute RF QPE</p>
<p><a class="reference internal" href="#module-rainforest.qpe.qpe_evaluation" title="rainforest.qpe.qpe_evaluation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rainforest.qpe.qpe_evaluation</span></code></a> : command-line utility to evaluate QPE products</p>
<p><a class="reference internal" href="#module-rainforest.qpe.qpe_plot" title="rainforest.qpe.qpe_plot"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rainforest.qpe.qpe_plot</span></code></a> : command-line utility to plot QPE products</p>
<div class="section" id="module-rainforest.qpe.evaluation">
<span id="rainforest-qpe-evaluation-module"></span><h2>rainforest.qpe.evaluation module<a class="headerlink" href="#module-rainforest.qpe.evaluation" title="Permalink to this headline">¶</a></h2>
<p>Main function to evaluate QPE runs with gauge data</p>
<p>Daniel Wolfensberger
MeteoSwiss/EPFL
<a class="reference external" href="mailto:daniel&#46;wolfensberger&#37;&#52;&#48;epfl&#46;ch">daniel<span>&#46;</span>wolfensberger<span>&#64;</span>epfl<span>&#46;</span>ch</a>
December 2019</p>
<dl class="function">
<dt id="rainforest.qpe.evaluation.evaluation">
<code class="sig-prename descclassname">rainforest.qpe.evaluation.</code><code class="sig-name descname">evaluation</code><span class="sig-paren">(</span><em class="sig-param">qpefolder, gaugepattern, list_models=None, outputfolder='./', t0=None, t1=None, bounds10=[0, 2, 10, 100], bounds60=[0, 1, 10, 100]</em><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.evaluation.evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>PErforms an evaluation of QPE products with reference gauge data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qpefolder</strong> (<em>str</em>) – Main directory where the QPE data is stored, each model corresponding
to a subfolder, as given by qpe_compute.py</p></li>
<li><p><strong>gaugepattern</strong> (<em>str</em>) – The pattern of gauge files that contain the gauge data.
on CSCS: ‘/store/msrad/radar/radar_database/gauge/<a href="#id1"><span class="problematic" id="id2">*</span></a>.csv.gz’</p></li>
<li><p><strong>t0</strong> (<em>datetime.datetime instance</em>) – starting time of the time range, default is first timestep available</p></li>
<li><p><strong>t1</strong> (<em>datetime.datetime instance</em>) – end time of the time range, default is last timestep available</p></li>
<li><p><strong>bounds10</strong> (<em>list of float</em>) – list of precipitation bounds for which to compute scores separately
at 10 min time resolution
[0,2,10,100] will give scores in range [0-2], [2-10] and [10-100]</p></li>
<li><p><strong>bounds60</strong> (<em>list of float</em>) – list of precipitation bounds for which to compute scores separately
at hourly time resolution
[0,1,10,100] will give scores in range [0-1], [1-10] and [10-100]</p></li>
<li><p><strong>list_models</strong> (<em>list of str</em>) – list of models to use in the evaluation, default is to use all
subfolders (models) available in qpefolder</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-rainforest.qpe.qpe">
<span id="rainforest-qpe-qpe-module"></span><h2>rainforest.qpe.qpe module<a class="headerlink" href="#module-rainforest.qpe.qpe" title="Permalink to this headline">¶</a></h2>
<p>Main function to compute the randomForest QPE estimate</p>
<p>Daniel Wolfensberger
MeteoSwiss/EPFL
<a class="reference external" href="mailto:daniel&#46;wolfensberger&#37;&#52;&#48;epfl&#46;ch">daniel<span>&#46;</span>wolfensberger<span>&#64;</span>epfl<span>&#46;</span>ch</a>
December 2019</p>
<dl class="class">
<dt id="rainforest.qpe.qpe.QPEProcessor">
<em class="property">class </em><code class="sig-prename descclassname">rainforest.qpe.qpe.</code><code class="sig-name descname">QPEProcessor</code><span class="sig-paren">(</span><em class="sig-param">config_file</em>, <em class="sig-param">models</em><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe.QPEProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates a QPEProcessor object which can be used to compute QPE
realizations with the RandomForest Regressors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>str</em>) – A yaml file containing all necessary options for the QPE algorithm
check the default_config.yml file to see which keys are required</p></li>
<li><p><strong>models</strong> (<em>dict</em>) – A dictionary containing all RF models to use for prediction,
keys in this dictionary are used to store outputs in separate
folders whereas the values must be valid RF regressor instances
as stored in the rf_models subfolder</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="rainforest.qpe.qpe.QPEProcessor.compute">
<code class="sig-name descname">compute</code><span class="sig-paren">(</span><em class="sig-param">output_folder</em>, <em class="sig-param">t0</em>, <em class="sig-param">t1</em>, <em class="sig-param">timestep=5</em>, <em class="sig-param">basename='RF%y%j%H%M'</em><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe.QPEProcessor.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes QPE values for a given time range and stores them in a
folder, in a binary format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_folder</strong> (<em>str</em>) – Folder where to store the computed QPE fields, note that subfolders
for every model will be created in this folder</p></li>
<li><p><strong>t0</strong> (<em>datetime</em>) – Start time of the timerange in datetime format</p></li>
<li><p><strong>t1</strong> (<em>datetime</em>) – End time of the timerange in datetime format</p></li>
<li><p><strong>timestep</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – In case you don’t to generate a new product every 5 minute, you can
change the time here, f.ex. 10 min, will compute the QPE only every
two sets of radar scans</p></li>
<li><p><strong>basename</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – Pattern for the filenames, default is  ‘RF%y%j%H%M’ which uses
the same standard as other MeteoSwiss products
(example RF191011055)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rainforest.qpe.qpe.QPEProcessor.fetch_data">
<code class="sig-name descname">fetch_data</code><span class="sig-paren">(</span><em class="sig-param">t0</em>, <em class="sig-param">t1</em><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe.QPEProcessor.fetch_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves and add new polar radar and status data to the QPEProcessor
for a given time range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> (<em>datetime</em>) – Start time of the timerange in datetime format</p></li>
<li><p><strong>t1</strong> (<em>datetime</em>) – End time of the timerange in datetime format</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rainforest.qpe.qpe_compute">
<span id="rainforest-qpe-qpe-compute-module"></span><h2>rainforest.qpe.qpe_compute module<a class="headerlink" href="#module-rainforest.qpe.qpe_compute" title="Permalink to this headline">¶</a></h2>
<p>Command line script for the RandomForest QPE</p>
<p>see <a class="reference internal" href="qpe_cmd.html#qpe-compute"><span class="std std-ref">qpe_compute</span></a></p>
<dl class="function">
<dt id="rainforest.qpe.qpe_compute.main">
<code class="sig-prename descclassname">rainforest.qpe.qpe_compute.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe_compute.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-rainforest.qpe.qpe_evaluation">
<span id="rainforest-qpe-qpe-evaluation-module"></span><h2>rainforest.qpe.qpe_evaluation module<a class="headerlink" href="#module-rainforest.qpe.qpe_evaluation" title="Permalink to this headline">¶</a></h2>
<p>Command line script to evaluate a set of QPE realizations using gauge data
as reference</p>
<p>see <a class="reference internal" href="qpe_cmd.html#qpe-evaluation"><span class="std std-ref">qpe_evaluation</span></a></p>
<dl class="function">
<dt id="rainforest.qpe.qpe_evaluation.main">
<code class="sig-prename descclassname">rainforest.qpe.qpe_evaluation.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe_evaluation.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-rainforest.qpe.qpe_plot">
<span id="rainforest-qpe-qpe-plot-module"></span><h2>rainforest.qpe.qpe_plot module<a class="headerlink" href="#module-rainforest.qpe.qpe_plot" title="Permalink to this headline">¶</a></h2>
<p>Command line script to display QPE realisazions</p>
<p>see <a class="reference internal" href="qpe_cmd.html#qpe-plot"><span class="std std-ref">qpe_plot</span></a></p>
<dl class="function">
<dt id="rainforest.qpe.qpe_plot.main">
<code class="sig-prename descclassname">rainforest.qpe.qpe_plot.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rainforest.qpe.qpe_plot.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="db.html" class="btn btn-neutral float-right" title="Database submodule" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="qpe_cmd.html" class="btn btn-neutral float-left" title="QPE command-line tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Daniel Wolfensherger

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>